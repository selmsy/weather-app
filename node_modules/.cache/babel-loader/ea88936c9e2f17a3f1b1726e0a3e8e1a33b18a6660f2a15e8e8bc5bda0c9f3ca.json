{"ast":null,"code":"import _regeneratorRuntime from\"/Users/selma/Documents/Projects/w-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/selma/Documents/Projects/w-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/selma/Documents/Projects/w-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";var BASE_URL='http://api.openweathermap.org';var useForecast=function useForecast(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),term=_useState2[0],setTerm=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),options=_useState4[0],setOptions=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),city=_useState6[0],setCity=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),forecast=_useState8[0],setForecast=_useState8[1];var getSearchOptions=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(term){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:fetch(\"\".concat(BASE_URL,\"/geo/1.0/direct?q=\").concat(term.trim(),\"&limit=5&appid=\").concat(process.env.REACT_APP_API_KEY)).then(function(res){return res.json();}).then(function(data){return setOptions(data);}).catch(function(ev){return console.log({ev:ev});});case 1:case\"end\":return _context.stop();}},_callee);}));return function getSearchOptions(_x){return _ref.apply(this,arguments);};}();var onInputChange=function onInputChange(ev){var value=ev.target.value.trim();setTerm(ev.target.value);if(value!==''){getSearchOptions(value);}};var getForecast=function getForecast(data){fetch(\"\".concat(BASE_URL,\"/data/2.5/weather?q=\").concat(data.lat,\"&lon=\").concat(data.lon,\"&units=metric&appid=\").concat(process.env.REACT_APP_API_KEY)).then(function(res){return res.json();}).then(function(data){return setForecast(data);});};var onSubmit=function onSubmit(){if(!city)return;getForecast(city);};var onOptionSelect=function onOptionSelect(option){setCity(option);};useEffect(function(){if(city){setTerm(city.name);setOptions([]);}},[city]);return{forecast:forecast,options:options,term:term,onOptionSelect:onOptionSelect,onSubmit:onSubmit,onInputChange:onInputChange};};export default useForecast;","map":{"version":3,"names":["useState","useEffect","BASE_URL","useForecast","term","setTerm","options","setOptions","city","setCity","forecast","setForecast","getSearchOptions","fetch","trim","process","env","REACT_APP_API_KEY","then","res","json","data","catch","ev","console","log","onInputChange","value","target","getForecast","lat","lon","onSubmit","onOptionSelect","option","name"],"sources":["/Users/selma/Documents/Projects/w-app/src/hooks/useForecast.ts"],"sourcesContent":[" import { useState, useEffect, ChangeEvent } from \"react\"\n \n import { optionType, forecastType } from \"../types\"\n \n const BASE_URL = 'http://api.openweathermap.org'\n\n const useForecast = () => {\n const [term, setTerm] = useState<string>('')\n const [options, setOptions] = useState<[]>([])\nconst [city, setCity] = useState<optionType | null >(null)\nconst [forecast, setForecast] = useState<forecastType | null>(null)\n\n const getSearchOptions = async (term: string) => {\n  fetch(`${BASE_URL}/geo/1.0/direct?q=${term.trim()}&limit=5&appid=${process.env.REACT_APP_API_KEY}`)\n .then((res)=>res.json())\n .then((data) => setOptions(data))\n .catch((ev) => console.log({ ev }))\n}\n \nconst onInputChange = (ev: ChangeEvent<HTMLInputElement>) => {\n  const value = ev.target.value.trim();\n  setTerm(ev.target.value);\n\n  if(value !== '') {\n    getSearchOptions(value)\n  }\n  \n  \n }\n\n const getForecast = (data: optionType) => {\nfetch(`${BASE_URL}/data/2.5/weather?q=${data.lat}&lon=${data.lon}&units=metric&appid=${process.env.REACT_APP_API_KEY}`)\n.then((res)=>res.json())\n.then((data) => setForecast((data)))\n\n }\n\n const onSubmit = () => {\nif(!city)  return\ngetForecast(city)\n\n\n }\n\n const onOptionSelect = (option: optionType) => {\n  setCity(option)\n }\n\n\n\n useEffect(() => {\n  if(city) {\n    setTerm(city.name)\n    setOptions([])\n  }\n\n }, [city])\n\n return {\n  forecast,\n  options,\n  term,\n  onOptionSelect,\n  onSubmit,\n  onInputChange,\n}\n\n}\n\nexport default useForecast"],"mappings":"iYAAC,OAASA,QAAQ,CAAEC,SAAS,KAAqB,OAAO,CAIxD,GAAMC,SAAQ,CAAG,+BAA+B,CAEhD,GAAMC,YAAW,CAAG,QAAdA,YAAW,EAAS,CAC1B,cAAwBH,QAAQ,CAAS,EAAE,CAAC,wCAArCI,IAAI,eAAEC,OAAO,eACpB,eAA8BL,QAAQ,CAAK,EAAE,CAAC,yCAAvCM,OAAO,eAAEC,UAAU,eAC3B,eAAwBP,QAAQ,CAAqB,IAAI,CAAC,yCAAnDQ,IAAI,eAAEC,OAAO,eACpB,eAAgCT,QAAQ,CAAsB,IAAI,CAAC,yCAA5DU,QAAQ,eAAEC,WAAW,eAE3B,GAAMC,iBAAgB,4FAAG,iBAAOR,IAAY,mHAC3CS,KAAK,WAAIX,QAAQ,8BAAqBE,IAAI,CAACU,IAAI,EAAE,2BAAkBC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAG,CACnGC,IAAI,CAAC,SAACC,GAAG,QAAGA,IAAG,CAACC,IAAI,EAAE,GAAC,CACvBF,IAAI,CAAC,SAACG,IAAI,QAAKd,WAAU,CAACc,IAAI,CAAC,GAAC,CAChCC,KAAK,CAAC,SAACC,EAAE,QAAKC,QAAO,CAACC,GAAG,CAAC,CAAEF,EAAE,CAAFA,EAAG,CAAC,CAAC,GAAC,sDACnC,kBALMX,iBAAgB,4CAKtB,CAED,GAAMc,cAAa,CAAG,QAAhBA,cAAa,CAAIH,EAAiC,CAAK,CAC3D,GAAMI,MAAK,CAAGJ,EAAE,CAACK,MAAM,CAACD,KAAK,CAACb,IAAI,EAAE,CACpCT,OAAO,CAACkB,EAAE,CAACK,MAAM,CAACD,KAAK,CAAC,CAExB,GAAGA,KAAK,GAAK,EAAE,CAAE,CACff,gBAAgB,CAACe,KAAK,CAAC,CACzB,CAGD,CAAC,CAED,GAAME,YAAW,CAAG,QAAdA,YAAW,CAAIR,IAAgB,CAAK,CAC3CR,KAAK,WAAIX,QAAQ,gCAAuBmB,IAAI,CAACS,GAAG,iBAAQT,IAAI,CAACU,GAAG,gCAAuBhB,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAG,CACtHC,IAAI,CAAC,SAACC,GAAG,QAAGA,IAAG,CAACC,IAAI,EAAE,GAAC,CACvBF,IAAI,CAAC,SAACG,IAAI,QAAKV,YAAW,CAAEU,IAAI,CAAE,GAAC,CAEnC,CAAC,CAED,GAAMW,SAAQ,CAAG,QAAXA,SAAQ,EAAS,CACxB,GAAG,CAACxB,IAAI,CAAG,OACXqB,WAAW,CAACrB,IAAI,CAAC,CAGhB,CAAC,CAED,GAAMyB,eAAc,CAAG,QAAjBA,eAAc,CAAIC,MAAkB,CAAK,CAC9CzB,OAAO,CAACyB,MAAM,CAAC,CAChB,CAAC,CAIDjC,SAAS,CAAC,UAAM,CACf,GAAGO,IAAI,CAAE,CACPH,OAAO,CAACG,IAAI,CAAC2B,IAAI,CAAC,CAClB5B,UAAU,CAAC,EAAE,CAAC,CAChB,CAED,CAAC,CAAE,CAACC,IAAI,CAAC,CAAC,CAEV,MAAO,CACNE,QAAQ,CAARA,QAAQ,CACRJ,OAAO,CAAPA,OAAO,CACPF,IAAI,CAAJA,IAAI,CACJ6B,cAAc,CAAdA,cAAc,CACdD,QAAQ,CAARA,QAAQ,CACRN,aAAa,CAAbA,aACF,CAAC,CAED,CAAC,CAED,cAAevB,YAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}